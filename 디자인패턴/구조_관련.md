
# **ν”„λ΅μ‹ ν¨ν„΄**

ν”„λ΅μ‹ ν¨ν„΄μ κΈ°λ³Έ κΈ°λ¥μ€ **ν”„λ΅μ‹ ν΄λμ¤λ¥Ό μƒμ„±ν•μ—¬ μ›λ³Έ ν΄λμ¤μ™€ κ΄€λ ¨μ΄ μ—†λ” κΈ°λ¥μ„ μ¶”κ°€ν•λ” κ²ƒ** μ΄λ‹¤.  
1. μ£Όμ” λΉ„μ¦λ‹μ¤μ™€ κ΄€λ ¨ μ—†λ” μ”κµ¬ μ‚¬ν•­μ κ°λ°μ— ν™μ©λ  μ μλ‹¤.
   - λ¨λ‹ν„°λ§, ν†µκ³„, μΈμ¦, νΈλν”½ μ ν•, νΈλμ­μ…, λ©±λ“±μ„±, λ΅κΉ…κ³Ό κ°™μ΄ μ£Όμ” λΉ„μ¦λ‹μ¤μ™€ κ΄€λ ¨μ—†λ” μ”κµ¬ μ‚¬ν•­μ„ κ°λ°ν•λ”λ° μ ν•©ν•λ‹¤.
2. RPCμ—μ„ ν”„λ΅μ‹ ν¨ν„΄μ„ μ μ©ν•  μ μλ‹¤.
   - RPC ν”„λ μ„μ›ν¬λ” ν”„λ΅μ‹ ν¨ν„΄μ μ‘μ© ν”„λ΅κ·Έλ¨μ΄λ‹¤.
3. μΊμ‹μ— ν”„λ΅μ‹ ν¨ν„΄μ„ μ μ©ν•  μ μλ‹¤.


## μΈν„°νμ΄μ¤ κΈ°λ°μ ν”„λ΅μ‹ ν¨ν„΄

ν”„λ΅μ‹ ν¨ν„΄μ€ μ›λ³Έ ν΄λμ¤λ¥Ό λ³€κ²½ν•μ§€ μ•μ€ μƒνƒλ΅ **ν”„λ΅μ‹ ν΄λμ¤**λ¥Ό λ„μ…ν•μ—¬ μ›λ³Έ ν΄λμ¤μ™€ κ΄€λ ¨ μ—†λ” μƒλ΅μ΄ κΈ°λ¥μ„ μ¶”κ°€ν•λ” κ²ƒμ΄λ‹¤.  

```kotlin
class UserController(
  private val metricsCollector: MetricsCollector
) {
  
  fun login(tel: String, password: String) : UserVO {
    // ν•µμ‹¬ μ™Έ κΈ°λ¥ : μ‹¤ν–‰ μ‹μ‘ μ‹κ°„ κΈ°λ΅

    // ν•µμ‹¬ : λΉ„μ¦λ‹μ¤ λ΅μ§

    // ν•µμ‹¬ μ™Έ κΈ°λ¥ : μ‹¤ν–‰ κ²°κ³Ό μ‹κ°„ κ³„μ‚° λ° Metricμ „λ‹¬
  }
}
```

μ„μ μμ λ¥Ό λ³΄λ©΄ **μ„±λ¥ ν†µκ³„ μ½”λ“κ°€ λΉ„μ¦λ‹μ¤ μ½”λ“λ¥Ό μΉ¨λ²”ν•΄ λ°€μ ‘ν•κ² κ²°ν•©λμ–΄ μλ‹¤.**  
μ΄ν›„ `MetricsCollector`κ°€ λ³€κ²½λμ–΄μ•Ό ν•λ‹¤λ©΄ ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ—λ„ μμ •μ΄ μΌμ–΄λ‚  ν™•λ¥ μ΄ λ†’λ‹¤.  
  
μ΄λ• λΉ„μ¦λ‹μ¤ μ½”λ“μ—μ„ μ„±λ¥ ν†µκ³„ μ½”λ“λ¥Ό λ¶„λ¦¬ν•κΈ° μ„ν•΄ ν”„λ΅μ‹ ν¨ν„΄μ΄ μ μ©ν•κ² μ‚¬μ©λ  μ μλ‹¤.  

```kotlin
interface IUserController {
    fun login(tel: String, password: String) : UserVO
}

class UserController: IUserController {
    override fun login(tel: String, password: String): UserVO {
        // ν•µμ‹¬ λ΅μ§
    }
}

class UserControllerProxy (
    private val target: IUserController,
    private val metricsCollector: MetricsCollector
) : IUserController {
    override fun login(tel: String, password: String): UserVO {
        // λ¶€κ°€ κΈ°λ¥
        target.login(tel, password)
        // λ¶€κ°€ κΈ°λ¥
    }
}
```

μ„μ μ½”λ“μ—μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” `IUserController` νƒ€μ…μ— μμ΅΄ν•μ§€λ§ μ‹¤μ  κµ¬ν„μ²΄λ¥Ό `UserControllerProxy`λ΅ μ£Όμ…ν•κ² λλ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” ν”„λ΅μ‹μ κΈ°λ¥ μ΅΄μ¬λ¥Ό μ•μ•„μ°¨λ¦΄ μ μ—†λ‹¤.  

## μƒμ† κΈ°λ°μ ν”„λ΅μ‹ ν¨ν„΄

μΈν„°νμ΄μ¤ κΈ°λ°μ ν”„λ΅μ‹ ν¨ν„΄μ—μ„λ” μ›λ³Έ ν΄λμ¤μ™€ ν”„λ΅μ‹ ν΄λμ¤κ°€ λ™μΌν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν–λ‹¤.  
ν•μ§€λ§ μ›λ³Έ ν΄λμ¤κ°€ μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬μ ν΄λμ¤μΌ λΏλ§ μ•„λ‹λΌ μΈν„°νμ΄μ¤λ¥Ό μ •μν•μ§€ μ•κ³  μμ–΄μ„ ν΄λμ¤λ¥Ό μ§μ ‘ μμ •ν•  μ μ—†λ” κ²½μ°μ— μ ν•©ν•λ‹¤.  

```kotlin
open class UserController {
    open fun login(tel: String, password: String): UserVO {
        // ν•µμ‹¬ λ΅μ§
    }
}

class UserControllerProxy (
    private val metricsCollector: MetricsCollector
) : UserController() {
    override fun login(tel: String, password: String): UserVO {
        // λ¶€κ°€ κΈ°λ¥
        super.login(tel, password)
        // λ¶€κ°€ κΈ°λ¥
    }
}
```

## λ¦¬ν”λ ‰μ… κΈ°λ°μ λ™μ  ν”„λ΅μ‹

μ•μ μμ λ” ν”„λ΅μ‹ ν΄λμ¤κ°€ μ›λ³Έ ν΄λμ¤μ λ¨λ“  λ©”μ„λ“λ¥Ό λ‹¤μ‹ κµ¬ν„ν•΄μ•Όν•κΈ° λ•λ¬Έμ— λ²κ±°λ΅­λ‹¤.  
κ·Έλ¦¬κ³  ν”„λ΅μ‹ ν΄λμ¤κ°€ λμ–΄λ‚ μλ΅ λ³µμ΅λ„κ°€ μ»¤μ§„λ‹¤.  
  
μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μλ” λ°©λ²•μ€ **λ™μ  ν”„λ΅μ‹** λ¥Ό μ‚¬μ©ν•μ—¬ κ° μ›λ³Έ ν΄λμ¤μ— λ€ν• ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ―Έλ¦¬ μ‘μ„±ν•λ” λ€μ‹ , `μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ” λ„μ¤‘μ— μ›λ³Έ ν΄λμ¤μ— λ€ν• ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ™μ μΌλ΅ μƒμ„±ν•κ³ , μ½”λ“ λ‚΄μ μ›λ³Έ ν΄λμ¤λ¥Ό ν”„λ΅μ‹ ν΄λμ¤λ΅ λ€μ²΄ν•λ” κ²ƒ`μ„ λ§ν•λ‹¤.  
ν†µκ³„μ  μ„±λ¥μ΄ ν•„μ”ν• ν΄λμ¤λ¥Ό μ„ν•΄ ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ™μ μΌλ΅ μƒμ„±ν•΄μ£Όλ” `MetricsControllerProxy` λ™μ  ν”„λ΅μ‹ ν΄λμ¤λ¥Ό ν™•μΈν•΄λ³΄μ.

```kotlin
class MetricsControllerProxy (
    private val metricsCollector: MetricsCollector
) {

    fun createProxy(proxiedObject: Any) : Any {
        val interfaces : Array<Class<*>> = proxiedObject.javaClass.interfaces
        val dynamicProxyHandler = DynamicProxyHandler(proxiedObject)
        return Proxy.newProxyInstance(
            proxiedObject.javaClass.classLoader,
            interfaces,
            dynamicProxyHandler
        )
    }

    class DynamicProxyHandler (
        private val proxiedObject: Any
    ) : InvocationHandler {
        override fun invoke(proxy: Any, method: Method, args: Array<out Any>): Any {
            val startTimeStamp = System.currentTimeMillis()

            val result = method.invoke(proxiedObject, args)

            val endTimeStamp = System.currentTimeMillis()
            val responseTime = endTimeStamp - startTimeStamp

            // responseTime Metric κΈ°λ΅
            return result
        }
    }
}

class Client {
  val proxy = MetricsControllerProxy(MetricsCollector())
  val controller: IUserController = proxy.createProxy(UserController()) as IUserController
}
```

***

# **[λ°μ½”λ μ΄ν„° ν¨ν„΄](https://github.com/jdalma/design-patterns/commit/9537c45bc4b9c53e0f9af0d4bd48c7503998fc2d)**

## ν¨ν„΄ μ†κ°

- Javaμ `IO ν΄λμ¤ λΌμ΄λΈλ¬λ¦¬`κ°€ κ°€μ§€κ³  μλ” κΈ°λ³Έ μ„¤κ³„ μ‚¬μƒμ„ λ¶„μ„ν•μ—¬ λ°μ½”λ μ΄ν„° ν¨ν„΄μ„ μ„¤λ…ν•  μ μλ‹¤. // TODO
- **κΈ°μ΅΄ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  λ¶€κ°€ κΈ°λ¥μ„ μ¶”κ°€ν•λ” ν¨ν„΄**
- μƒμ†μ΄ μ•„λ‹ μ„μ„μ„ μ‚¬μ©ν•΄μ„ λ³΄λ‹¤ μ μ—°ν•κ² (λ°νƒ€μ„μ—) λ¶€κ°€ κΈ°λ¥μ„ μ¶”κ°€ν•λ” κ²ƒλ„ κ°€λ¥ν•λ‹¤.

![](imgs/structureRelated/decorator.png)

```java
public static void main(String[] args) {
    CommentService commentService = new DefaultCommentService();

    if (enabledSpamFilter) {
        commentService = new SpamFilteringCommentDecorator(commentService);
    }

    if (enabledTrimming) {
        commentService = new TrimmingCommentDecorator(commentService);
    }
    ...
}
```
- μ΄ μ½”λ“λ¥Ό λ³΄λ©΄ λ€λµ μ• μ μμ„ κ²ƒμ΄λ‹¤.

## μ¥μ κ³Ό λ‹¨μ 

- **μ¥μ **
  - μƒλ΅μ΄ ν΄λμ¤λ¥Ό λ§λ“¤μ§€ μ•κ³  **κΈ°μ΅΄ κΈ°λ¥μ„ μ΅°ν•©ν•  μ μλ‹¤.**
  - μ»΄νμΌ νƒ€μ„μ΄ μ•„λ‹ λ°νƒ€μ„μ— λ™μ μΌλ΅ κΈ°λ¥μ„ λ³€κ²½ν•  μ μλ‹¤.
- **λ‹¨μ **
  - λ°μ½”λ μ΄ν„°λ¥Ό μ΅°ν•©ν•λ” μ½”λ“κ°€ λ³µμ΅ν•  μ μλ‹¤.

## μ μ© μμ 

1. `InputStream`, `OutputStream`, `Reader`, `Writer`μ μƒμ„±μλ¥Ό ν™μ©ν• λ©νΌ
2. `Collections`μ΄ μ κ³µν•λ” λ°μ½”λ μ΄ν„° λ©”μ†λ“
   - `Collections.checkedXXX()`
   - `Collections.synchronizedXXX()`
   - `Collections.unmodifiableXXX()`
3. μ›Ήν”λ­μ¤ `ServerHttpRequestDecorator`, `ServerHttpResponseDecorator`
4. λΉ μ„¤μ • λ°μ½”λ μ΄ν„° `BeanDefinitionDecorator`

***

# **[μ–΄λ‘ν„° ν¨ν„΄](https://github.com/jdalma/design-patterns/tree/master/src/main/java/me/whiteship/designpatterns/_02_structural_patterns/_06_adapter)**

## ν¨ν„΄ μ†κ°

- ν΄λμ¤ μ–΄λ‘ν„°μ™€ κ°μ²΄ μ–΄λ‘ν„°μ— λ€ν•΄ μ‚΄ν΄λ³΄κ³ , λ‹¤μ„― κ°€μ§€ μ‘μ© λ°©λ²•μ— λ€ν•΄ μ•μ•„λ³΄μ // TODO
- **κΈ°μ΅΄ μ½”λ“λ¥Ό ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©ν•λ” μΈν„°νμ΄μ¤μ κµ¬ν„μ²΄λ΅ λ°”κΏ”μ£Όλ” ν¨ν„΄**
  - *ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©ν•λ” μΈν„°νμ΄μ¤λ¥Ό λ”°λ¥΄μ§€ μ•λ” κΈ°μ΅΄ μ½”λ“λ¥Ό μ¬μ‚¬μ©ν•  μ μκ² ν•΄μ¤€λ‹¤*

![](imgs/structureRelated/adapterDiagram.png)

![](imgs/structureRelated/adapter1.png)

- **UserDetail** , **UserDetailsService** μΈν„°νμ΄μ¤κ°€ `Target`μ— ν•΄λ‹Ήν•λ‹¤
- **Account** μ™€ **AccountService**κ°€ `Adaptee`μ— ν•΄λ‹Ήν•λ‹¤
- π“
  - μ–΄λ–»κ² **UserDetailsService**μ™€ **AccountService**λ¥Ό μ—°κ²°ν•  κ²ƒ μΈκ°€?
  - μ–΄λ–»κ² **Account**μ™€ **UserDetails**λ¥Ό μ—°κ²°ν•  κ²ƒμΈκ°€?

***

# **λΈλ¦¬μ§€ ν¨ν„΄**

// TODO