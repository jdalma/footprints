
# **í”„ë¡ì‹œ íŒ¨í„´**

í”„ë¡ì‹œ íŒ¨í„´ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì€ **í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ì›ë³¸ í´ë˜ìŠ¤ì™€ ê´€ë ¨ì´ ì—†ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒ** ì´ë‹¤.  
1. ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ê´€ë ¨ ì—†ëŠ” ìš”êµ¬ ì‚¬í•­ì˜ ê°œë°œì— í™œìš©ë  ìˆ˜ ìˆë‹¤.
   - ëª¨ë‹ˆí„°ë§, í†µê³„, ì¸ì¦, íŠ¸ë˜í”½ ì œí•œ, íŠ¸ëœì­ì…˜, ë©±ë“±ì„±, ë¡œê¹…ê³¼ ê°™ì´ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ê´€ë ¨ì—†ëŠ” ìš”êµ¬ ì‚¬í•­ì„ ê°œë°œí•˜ëŠ”ë° ì í•©í•˜ë‹¤.
2. RPCì—ì„œ í”„ë¡ì‹œ íŒ¨í„´ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
   - RPC í”„ë ˆì„ì›Œí¬ëŠ” í”„ë¡ì‹œ íŒ¨í„´ì˜ ì‘ìš© í”„ë¡œê·¸ë¨ì´ë‹¤.
3. ìºì‹œì— í”„ë¡ì‹œ íŒ¨í„´ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.


## ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì˜ í”„ë¡ì‹œ íŒ¨í„´

í”„ë¡ì‹œ íŒ¨í„´ì€ ì›ë³¸ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ **í”„ë¡ì‹œ í´ë˜ìŠ¤**ë¥¼ ë„ì…í•˜ì—¬ ì›ë³¸ í´ë˜ìŠ¤ì™€ ê´€ë ¨ ì—†ëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì´ë‹¤.  

```kotlin
class UserController(
  private val metricsCollector: MetricsCollector
) {
  
  fun login(tel: String, password: String) : UserVO {
    // í•µì‹¬ ì™¸ ê¸°ëŠ¥ : ì‹¤í–‰ ì‹œì‘ ì‹œê°„ ê¸°ë¡

    // í•µì‹¬ : ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

    // í•µì‹¬ ì™¸ ê¸°ëŠ¥ : ì‹¤í–‰ ê²°ê³¼ ì‹œê°„ ê³„ì‚° ë° Metricì „ë‹¬
  }
}
```

ìœ„ì˜ ì˜ˆì œë¥¼ ë³´ë©´ **ì„±ëŠ¥ í†µê³„ ì½”ë“œê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œë¥¼ ì¹¨ë²”í•´ ë°€ì ‘í•˜ê²Œ ê²°í•©ë˜ì–´ ìˆë‹¤.**  
ì´í›„ `MetricsCollector`ê°€ ë³€ê²½ë˜ì–´ì•¼ í•œë‹¤ë©´ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë„ ìˆ˜ì •ì´ ì¼ì–´ë‚  í™•ë¥ ì´ ë†’ë‹¤.  
  
ì´ë•Œ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œì—ì„œ ì„±ëŠ¥ í†µê³„ ì½”ë“œë¥¼ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ í”„ë¡ì‹œ íŒ¨í„´ì´ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.  

```kotlin
interface IUserController {
    fun login(tel: String, password: String) : UserVO
}

class UserController: IUserController {
    override fun login(tel: String, password: String): UserVO {
        // í•µì‹¬ ë¡œì§
    }
}

class UserControllerProxy (
    private val target: IUserController,
    private val metricsCollector: MetricsCollector
) : IUserController {
    override fun login(tel: String, password: String): UserVO {
        // ë¶€ê°€ ê¸°ëŠ¥
        target.login(tel, password)
        // ë¶€ê°€ ê¸°ëŠ¥
    }
}
```

ìœ„ì˜ ì½”ë“œì—ì„œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” `IUserController` íƒ€ì…ì— ì˜ì¡´í•˜ì§€ë§Œ ì‹¤ì œ êµ¬í˜„ì²´ë¥¼ `UserControllerProxy`ë¡œ ì£¼ì…í•˜ê²Œ ë˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” í”„ë¡ì‹œì˜ ê¸°ëŠ¥ ì¡´ì¬ë¥¼ ì•Œì•„ì°¨ë¦´ ìˆ˜ ì—†ë‹¤.  

## ìƒì† ê¸°ë°˜ì˜ í”„ë¡ì‹œ íŒ¨í„´

ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì˜ í”„ë¡ì‹œ íŒ¨í„´ì—ì„œëŠ” ì›ë³¸ í´ë˜ìŠ¤ì™€ í”„ë¡ì‹œ í´ë˜ìŠ¤ê°€ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í–ˆë‹¤.  
í•˜ì§€ë§Œ ì›ë³¸ í´ë˜ìŠ¤ê°€ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í´ë˜ìŠ¤ì¼ ë¿ë§Œ ì•„ë‹ˆë¼ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ì§€ ì•Šê³  ìˆì–´ì„œ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì— ì í•©í•˜ë‹¤.  

```kotlin
open class UserController {
    open fun login(tel: String, password: String): UserVO {
        // í•µì‹¬ ë¡œì§
    }
}

class UserControllerProxy (
    private val metricsCollector: MetricsCollector
) : UserController() {
    override fun login(tel: String, password: String): UserVO {
        // ë¶€ê°€ ê¸°ëŠ¥
        super.login(tel, password)
        // ë¶€ê°€ ê¸°ëŠ¥
    }
}
```

## ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜ì˜ ë™ì  í”„ë¡ì‹œ

ì•ì˜ ì˜ˆì œëŠ” í”„ë¡ì‹œ í´ë˜ìŠ¤ê°€ ì›ë³¸ í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì„œë“œë¥¼ ë‹¤ì‹œ êµ¬í˜„í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ë²ˆê±°ë¡­ë‹¤.  
ê·¸ë¦¬ê³  í”„ë¡ì‹œ í´ë˜ìŠ¤ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ë³µì¡ë„ê°€ ì»¤ì§„ë‹¤.  
  
ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ **ë™ì  í”„ë¡ì‹œ** ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ì›ë³¸ í´ë˜ìŠ¤ì— ëŒ€í•œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë¯¸ë¦¬ ì‘ì„±í•˜ëŠ” ëŒ€ì‹ , `ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë„ì¤‘ì— ì›ë³¸ í´ë˜ìŠ¤ì— ëŒ€í•œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ê³ , ì½”ë“œ ë‚´ì˜ ì›ë³¸ í´ë˜ìŠ¤ë¥¼ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¡œ ëŒ€ì²´í•˜ëŠ” ê²ƒ`ì„ ë§í•œë‹¤.  
í†µê³„ì  ì„±ëŠ¥ì´ í•„ìš”í•œ í´ë˜ìŠ¤ë¥¼ ìœ„í•´ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” `MetricsControllerProxy` ë™ì  í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì.

```kotlin
fun main(args: Array<String>) {
    val proxy = MetricsControllerProxy()
    val controller: IUserController = proxy.createProxy(UserController()) as IUserController
    controller.hello("first")
    controller.bye("second")
}

interface IUserController {
    fun hello(name: String) : String
    fun bye(name: String) : String
}

class UserController : IUserController {
    override fun hello(name: String) = "hello $name"
    override fun bye(name: String) = "bye $name"
}

class MetricsControllerProxy {

    fun createProxy(proxiedObject: Any) : Any {
        val interfaces : Array<Class<*>> = proxiedObject.javaClass.interfaces
        val dynamicProxyHandler = DynamicProxyHandler(proxiedObject)
        return newProxyInstance(
            proxiedObject.javaClass.classLoader,
            interfaces,
            dynamicProxyHandler
        )
    }

    private class DynamicProxyHandler (
        private val proxiedObject: Any
    ) : InvocationHandler {
        override fun invoke(proxy: Any, method: Method, args: Array<out Any>): Any {
            val startTimeStamp = System.currentTimeMillis()

            val result = method.invoke(proxiedObject, args[0])

            val endTimeStamp = System.currentTimeMillis()
            val responseTime = endTimeStamp - startTimeStamp

            // responseTime Metric ê¸°ë¡
            println("response time : $responseTime, result : $result")

            return result
        }
    }
}
```

***

# **[ë°ì½”ë ˆì´í„° íŒ¨í„´](https://github.com/jdalma/design-patterns/commit/9537c45bc4b9c53e0f9af0d4bd48c7503998fc2d)**

## íŒ¨í„´ ì†Œê°œ

- Javaì˜ `IO í´ë˜ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬`ê°€ ê°€ì§€ê³  ìˆëŠ” ê¸°ë³¸ ì„¤ê³„ ì‚¬ìƒì„ ë¶„ì„í•˜ì—¬ ë°ì½”ë ˆì´í„° íŒ¨í„´ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤. // TODO
- **ê¸°ì¡´ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ë¶€ê°€ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” íŒ¨í„´**
- ìƒì†ì´ ì•„ë‹Œ ìœ„ì„ì„ ì‚¬ìš©í•´ì„œ ë³´ë‹¤ ìœ ì—°í•˜ê²Œ (ëŸ°íƒ€ì„ì—) ë¶€ê°€ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.

![](imgs/structureRelated/decorator.png)

```java
public static void main(String[] args) {
    CommentService commentService = new DefaultCommentService();

    if (enabledSpamFilter) {
        commentService = new SpamFilteringCommentDecorator(commentService);
    }

    if (enabledTrimming) {
        commentService = new TrimmingCommentDecorator(commentService);
    }
    ...
}
```
- ì´ ì½”ë“œë¥¼ ë³´ë©´ ëŒ€ëµ ì•Œ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

## ì¥ì ê³¼ ë‹¨ì 

- **ì¥ì **
  - ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•Šê³  **ê¸°ì¡´ ê¸°ëŠ¥ì„ ì¡°í•©í•  ìˆ˜ ìˆë‹¤.**
  - ì»´íŒŒì¼ íƒ€ì„ì´ ì•„ë‹Œ ëŸ°íƒ€ì„ì— ë™ì ìœ¼ë¡œ ê¸°ëŠ¥ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
- **ë‹¨ì **
  - ë°ì½”ë ˆì´í„°ë¥¼ ì¡°í•©í•˜ëŠ” ì½”ë“œê°€ ë³µì¡í•  ìˆ˜ ìˆë‹¤.

## ì ìš© ì˜ˆì œ

1. `InputStream`, `OutputStream`, `Reader`, `Writer`ì˜ ìƒì„±ìë¥¼ í™œìš©í•œ ë©í¼
2. `Collections`ì´ ì œê³µí•˜ëŠ” ë°ì½”ë ˆì´í„° ë©”ì†Œë“œ
   - `Collections.checkedXXX()`
   - `Collections.synchronizedXXX()`
   - `Collections.unmodifiableXXX()`
3. ì›¹í”ŒëŸ­ìŠ¤ `ServerHttpRequestDecorator`, `ServerHttpResponseDecorator`
4. ë¹ˆ ì„¤ì • ë°ì½”ë ˆì´í„° `BeanDefinitionDecorator`

***

# **[ì–´ëŒ‘í„° íŒ¨í„´](https://github.com/jdalma/design-patterns/tree/master/src/main/java/me/whiteship/designpatterns/_02_structural_patterns/_06_adapter)**

## íŒ¨í„´ ì†Œê°œ

- í´ë˜ìŠ¤ ì–´ëŒ‘í„°ì™€ ê°ì²´ ì–´ëŒ‘í„°ì— ëŒ€í•´ ì‚´í´ë³´ê³ , ë‹¤ì„¯ ê°€ì§€ ì‘ìš© ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì // TODO
- **ê¸°ì¡´ ì½”ë“œë¥¼ í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ë¡œ ë°”ê¿”ì£¼ëŠ” íŒ¨í„´**
  - *í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ” ê¸°ì¡´ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤*

![](imgs/structureRelated/adapterDiagram.png)

![](imgs/structureRelated/adapter1.png)

- **UserDetail** , **UserDetailsService** ì¸í„°í˜ì´ìŠ¤ê°€ `Target`ì— í•´ë‹¹í•œë‹¤
- **Account** ì™€ **AccountService**ê°€ `Adaptee`ì— í•´ë‹¹í•œë‹¤
- ğŸ“Œ
  - ì–´ë–»ê²Œ **UserDetailsService**ì™€ **AccountService**ë¥¼ ì—°ê²°í•  ê²ƒ ì¸ê°€?
  - ì–´ë–»ê²Œ **Account**ì™€ **UserDetails**ë¥¼ ì—°ê²°í•  ê²ƒì¸ê°€?

***

# **ë¸Œë¦¬ì§€ íŒ¨í„´**

// TODO